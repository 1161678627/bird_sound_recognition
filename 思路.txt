# 现在 在old的频谱图生成方式上，使用 EfficientNetB4 加上 lstm 和 一些 dense 作为模型进行预测
    - 测试效果如下：仅有70多的评分，效果不是很好，所以依旧采用new的处理方法，对不同时长的频谱图进行训练，先训练一个5s最好的new
    - new img 5s efnb3-lstm，先在数据增强的数据集上训练，测试下效果



# 现在出现了一个问题，新处理的new img数据，fine tuning 训练效果很差，所以现在重新对 img进行处理，设置最低的FMIN为20，再次测试
# 之前将FMIN修改为了0


# 有关于数据处理的新想法：①和之前想的一样，对每一个音频统计FMAX和FMIN，然后自己定义一个公式，用于判断切割后的子音频中是否包含鸟鸣
# ②扩大音频的切割时长，比如15s一段音频，以保证该段音频中肯定存在鸟鸣，然后每次增长 5s或者10s切割下一段音频，eg：0-15，5-20，10-25这样
Found 125362 images belonging to 100 classes.
Found 17926 images belonging to 100 classes.    # 以前单独分割5s后的分割数量

Found 104179 images belonging to 100 classes.
Found 15040 images belonging to 100 classes.

# 测试新的model--- vit 迁移学习


接下来还有几点可以优化：
1.是否对图片数据进行归一化 1/255.
    -已应用，有改进，但改进不多
    -还可以考虑norm 【0.5，0.5，0.5】，normlization取决于efficentnet-B3要求的参数

2.是否采用别的方式将wav文件转为图片文件---reducenoise否？
    -mel频谱处理方式参考下url，梅尔频谱的归一化，和最高最低限制频率FMIN
    -https://blog.csdn.net/hhhhhhhhhhwwwwwwwwww/article/details/116031884
    -我们用plt展示图片的时候实际上应该展示的是灰度图片，保存的也是灰度图，但是现在是彩色图，而且rgb有问题
    -已经用了新的方式进行频谱图的生成，似乎作用也不是太大

3.是否采用别的model进行训练，如增加更多的全连接层，或者结合lstm？
    -backbone这里目前没有做修改，还是采用的efficentnet-B3，有需要可以改为resnet、vgg等
    -目前新增了一些全连接层，然后减少了dropout的比例，希望该网络能够学习到更多数据特征---目前没有过拟合现象
    -尝试使用从头训练的模型，不使用预训练model，经过测试后发现确实从头训练新的model效果会更好一些
    -目前还是考虑修改一下网络，改用cnn+lstm去进行预测

4.test预测的时候是否用投票方式，还是用 概率max方式？
    -都已应用，有改进，但改进不多
    -每次predict的时候同时输出这两种结果，都提交上去
    -只应用最大概率maxprob的方法

5.是否可以在训练时增加更多的图片与处理方式？
    -偏移翻转等
    -目前看来数据增强似乎会对训练产生负面影响，因此去掉数据增强这一栏，当前数据集在5s层级上的分割其实已经很大了

6.还可以在进一步细化model的训练方式，先整体训练最后，修改学习率，仅训练全连接层
    -暂时还没有精修网络

7.early_stop似乎可以舍弃掉，该数据集的验证集数据分布似乎不太符合train数据集的分布，网络往往会突然停止训练
    -实际上train acc达到98的时候，测试集的acc也是上升的，并没有出现想象中的过拟合
    -考虑把validation的数据也拿到训练集中用于训练

# 现在在测试
1-是否从头训练model效果会更好
    -经过测试后发现确实从头训练新的model效果会更好一些
2-是否使用新的方法进行梅尔频谱图的生成效果会更好
    -新方法生成的灰度梅尔频谱图似乎图像大小不都一样
3-考虑转为torch训练model


# 现在有了推测，训练的epochs太多了，训练集准确率太高，会增加过拟合的现象，所以微调model的时候要适度，不同量级微调model
# 新增了lstm后，model确实性能有一定的提升，现在考虑如何更好的优化这部分，充分利用backbone和lstm